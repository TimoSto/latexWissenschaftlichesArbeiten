\NeedsTeXFormat{LaTeX2e}

\ProvidesPackage{literatur}

%Literatur-DB aus CSV laden
\usepackage{xstring}
\DTLloaddb{literatur}{literatur.csv}

%tatsächlich zitierte sachen laden
\DTLloaddb{citedKeys}{citedKeys.csv}

%Literaturverzeichnis printen
\newcommand{\printMyBibliography}[0]{
	
	\begin{center}
		\begin{LARGE}
			Literaturverzeichnis
		\end{LARGE}
	\end{center}
	%Jeder Eintrag in CSV-Datei (literatur-DB) wird auf den type überprüft und die Daten werden an den jeweiligen Command weitergegeben. (Falls type anders ist, kommt es zu einem Fehler)
	\DTLforeach*{literatur}
	{\key=key,\type=type,\a=a,\b=b,\c=c,\d=d,\e=e,\f=f,\g=g,\h=h}
	{
		\DTLforeach*{citedKeys}
		{\ckey=ckey}
		{
			\IfStrEqCase{\ckey}{
					{\key}{
				\IfStrEqCase{\type}{%
				%Area to add new bibifs via gui
		{Buch}{\printBuch{\a}{\b}{\c}{\d}{\e}}%
		{Kommentar}{\printKommentar{\a}{\b}{\c}{\d}{\e}}%
		{Aufsatz}{\printAufsatz{\a}{\b}{\c}{\d}{\e}}%
		{online}{\printonline{\a}{\b}{\c}{\d}{\e}}%
		{workingpaper}{\printworkingpaper{\a}{\b}{\c}{\d}{\e}}%
		{sammelwerk}{\printsammelwerk{\a}{\b}{\c}{\d}{\e}}%
		{hrsgsammel}{\printhrsgsammel{\a}{\b}{\c}{\d}{\e}{\f}{\g}}%
		{meintype}{\printmeintype{\a}{\b}{\c}}%
		{Test}{\printTest{\a}{\b}{\c}}%
		{AufsatzAusgabe}{\printAufsatzAusgabe{\a}{\b}{\c}{\d}{\e}{\f}}%
		{AufsatzURL}{\printAufsatzURL{\a}{\b}{\c}{\d}{\e}{\f}{\g}}%
		{onlineArticle}{\printonlineArticle{\a}{\b}{\c}{\d}{\e}}%
		{Norm}{\printNorm{\a}{\b}{\c}{\d}{\e}{\f}}%
		{TestM}{\printTestM{\a}{\b}}%
		{Handbuch}{\printHandbuch{\a}{\b}{\c}{\d}{\e}{\f}}%
		%end area
						{empty}{}%
				}[Oppsss, unknown case '\type'.]
			}
					{*}{
					\IfStrEqCase{\type}{%
					%Area to add new bibifs via gui
							{Buch}{\printBuch{\a}{\b}{\c}{\d}{\e}}%
							{Kommentar}{\printKommentar{\a}{\b}{\c}{\d}{\e}}%
							{Aufsatz}{\printAufsatz{\a}{\b}{\c}{\d}{\e}}%
							{online}{\printonline{\a}{\b}{\c}{\d}{\e}}%
							{workingpaper}{\printworkingpaper{\a}{\b}{\c}{\d}{\e}}%
							{sammelwerk}{\printsammelwerk{\a}{\b}{\c}{\d}{\e}}%
							{hrsgsammel}{\printhrsgsammel{\a}{\b}{\c}{\d}{\e}{\f}{\g}}%
							{meintype}{\printmeintype{\a}{\b}{\c}}%
							{Test}{\printTest{\a}{\b}{\c}}%
							{AufsatzAusgabe}{\printAufsatzAusgabe{\a}{\b}{\c}{\d}{\e}{\f}}%
							{AufsatzURL}{\printAufsatzURL{\a}{\b}{\c}{\d}{\e}{\f}{\g}}%
							{onlineArticle}{\printonlineArticle{\a}{\b}{\c}{\d}{\e}}%
							{Norm}{\printNorm{\a}{\b}{\c}{\d}{\e}{\f}}%
							{TestM}{\printTestM{\a}{\b}}%
							{Handbuch}{\printHandbuch{\a}{\b}{\c}{\d}{\e}{\f}}%
					%end area
							{empty}{}%
					}[Oppsss, unknown case '\type'.]
				}}
		}

	}
}

%!!!LEERZEILE IN PRINTS NICHT ENTFERNEN!!! (Sind wichtig, damit ab zweiter Zeile immer eingerückt ist)
\def\bibparindent{1.5em}
%Area to add new bibprints via gui
\newcommand{\printBuch}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3. Auflage, #4 #5
	\\
	\vspace{-12pt}

}
\newcommand{\printKommentar}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3. Auflage,#4#5
	\\
	\vspace{-12pt}

}
\newcommand{\printAufsatz}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, in: #3 (#4), #5 
	\\
	\vspace{-12pt}

}
\newcommand{\printonline}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3 (#4), abgerufen am #5
	\\
	\vspace{-12pt}

}
\newcommand{\printworkingpaper}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3, abrufbar unter: #4, abgerufen am: #5
	\\
	\vspace{-12pt}

}
\newcommand{\printsammelwerk}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1} (Hrsg.), #2, in: #3  (#4), #5
	\\
	\vspace{-12pt}

}
\newcommand{\printhrsgsammel}[7]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, in: #3 (#4), #5 (Hrsg.), #6, #7
	\\
	\vspace{-12pt}

}
\newcommand{\printmeintype}[3]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2 (#3)
	\\
	\vspace{-12pt}

}
\newcommand{\printTest}[3]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	#1#2#3
	\\
	\vspace{-12pt}

}
\newcommand{\printAufsatzAusgabe}[6]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, in: #3 (#4, Ausgabe #5), S.#6
	\\
	\vspace{-12pt}

}
\newcommand{\printAufsatzURL}[7]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	#1, #2, \textit{#3} #4, S. #5 (#6), abrufbar unter: #7
	\\
	\vspace{-12pt}

}
\newcommand{\printonlineArticle}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2 (#3), abrufbar unter \textit{#4}: #5
	\\
	\vspace{-12pt}

}
\newcommand{\printNorm}[6]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	#1 (Hrsg.) (\textit{#2}):#3, #4, #5, #6
	\\
	\vspace{-12pt}

}
\newcommand{\printTestM}[2]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2
	\\
	\vspace{-12pt}

}
\newcommand{\printHandbuch}[6]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1} (Hg.) (#2), #3, #4 (#5, #6)
	\\
	\vspace{-12pt}

}

		%end area

%Zitation => Suche nach Key in literatur-DB => Passenden Command aufrufen
%\newcommand{\citebib}[3]{%
%	\DTLforeach*{literatur}%
%	{\key=key,\type=type,\autor=autor,\titel=titel,\auflage=auflage,\ort=ort,\datum=datum,\hrsg=hrsg,\band=band,\zeitschrift=zeitschrift,\seiten=seiten,\festschrift=festschrift,\autorsammel=autorsammelwerk,\titelsammel=titelsammelwerk}%
%	{%
%	  \IfEqCase{\key}{{#1}{%
%		\IfEqCase{\type}{%
%	  	{buch}{\printbookfootnote{#2}{\autor}{\titel}{\datum}{#3}}%
%	  	%{hrsgbook}{\printhrsgbookfootnote{#2}{\autor}{\b}{\e}{#3}}%
%	  	{kommentar}{\printcommentfootnote{#2}{\autor}{\titel}{\datum}{#3}}%
%	  	{essay}{\printarticlefootnote{#2}{\autor}{\zeitschrift}{\datum}{#3}}%
%		{festschrift}{\printfestschriftfootnote{#2}{\autor}{\festschrift}{\datum}{#3}}%
%	  	{sammelwerk}{\printcollectionfootnote{#2}{\autor}{\autorsammel}{\titelsammel}{#3}}%
%	  	{online}{\printonlinefootnote{#2}{\autor}{\titel}{\titelsammel}{\datum}}%
%	  }%
%	  }}[]%
%	}%
%}
\usepackage{xcolor}

\newcommand{\citebib}[3]{%
	\citebibFootnote{#1}{#2}{#3}%
}

\newcommand{\useInlineCites}[0]{%
	\renewcommand{\citebib}[3]{%
		\citebibInline{##1}{##2}{##3}%
	}%
}%

\newcommand{\entryfound}{false}%
\newcommand{\citebibFootnote}[3]{{%
	\renewcommand{\entryfound}{false}%
	\DTLforeach*{literatur}%
	{\key=key,\type=type,\a=a,\b=b,\c=c,\d=d,\e=e,\f=f,\g=g,\h=h}%
	{%
		\IfStrEqCase{\key}{{#1}{%
			\renewcommand{\entryfound}{true}%
			\IfStrEqCase{\type}{%
				%Area to add citeifs via gui
			{Buch}{\footnote{#3\citeBuch{\a}{\b}{#2}.}}%
			{Kommentar}{\footnote{#3\citeKommentar{\a}{\b}{\e}{#2}.}}%
			{Aufsatz}{\footnote{#3\citeAufsatz{\a}{\c}{#2}.}}%
			{online}{\footnote{#3\citeonline{\f}{#2}.}}%
			{workingpaper}{\footnote{#3\citeworkingpaper{\f}{#2}.}}%
			{sammelwerk}{\footnote{#3\citesammelwerk{\a}{\b}{#2}.}}%
			{hrsgsammel}{\footnote{#3\citehrsgsammel{\a}{\b}{#2}.}}%
			{meintype}{\footnote{#3\citemeintype{\a}{\c}{#2}.}}%
			{Test}{\footnote{#3\citeTest{\a}{\c}{#2}.}}%
			{AufsatzAusgabe}{\footnote{#3\citeAufsatzAusgabe{\g}{\d}{#2}.}}%
			{AufsatzURL}{\footnote{#3\citeAufsatzURL{\c}{\f}{#2}.}}%
			{onlineArticle}{\footnote{#3\citeonlineArticle{\a}{\c}{#2}.}}%
			{Norm}{\footnote{#3\citeNorm{\b}{#2}.}}%
			{TestM}{\footnote{#3\citeTestM{\c}{#2}.}}%
			{Handbuch}{\footnote{#3\citeHandbuch{\g}{#2}.}}%
		%end area
			}[\footnote{{\color{red}Typ "\type " nicht gefunden. Ändern oder in literatur.sty hinzufügen (siehe README)}}]%
		}}%
	}%
	\IfStrEqCase{\entryfound}{%
		{false}{\footnote{{\color{red}Literatureintrag mit Key "#1 " nicht gefunden}}}%
	}%
}}

\newcommand{\citebibInline}[3]{{%
	\renewcommand{\entryfound}{false}%
	\DTLforeach*{literatur}%
	{\key=key,\type=type,\a=a,\b=b,\c=c,\d=d,\e=e,\f=f,\g=g,\h=h}%
	{%
		\IfStrEqCase{\key}{{#1}{%
			\renewcommand{\entryfound}{true}%
			\IfStrEqCase{\type}{%
			%Area to add citeifs_inline via gui
			{Buch}{ ({#3\citeBuch{\a}{\b}{#2})}}%
			{Kommentar}{ ({#3\citeKommentar{\a}{\b}{\e}{#2})}}%
			{Aufsatz}{ ({#3\citeAufsatz{\a}{\c}{#2})}}%
			{online}{ ({#3\citeonline{\f}{#2})}}%
			{workingpaper}{ ({#3\citeworkingpaper{\f}{#2})}}%
			{sammelwerk}{ ({#3\citesammelwerk{\a}{\b}{#2})}}%
			{hrsgsammel}{ ({#3\citehrsgsammel{\a}{\b}{#2})}}%
			{meintype}{ ({#3\citemeintype{\a}{\c}{#2})}}%
			{Test}{ ({#3\citeTest{\a}{\c}{#2})}}%
			{AufsatzAusgabe}{ ({#3\citeAufsatzAusgabe{\g}{\d}{#2})}}%
			{AufsatzURL}{ ({#3\citeAufsatzURL{\c}{\f}{#2})}}%
			{onlineArticle}{ ({#3\citeonlineArticle{\a}{\c}{#2})}}%
			{Norm}{ ({#3\citeNorm{\b}{#2})}}%
			{TestM}{ ({#3\citeTestM{\c}{#2})}}%
			{Handbuch}{ ({#3\citeHandbuch{\g}{#2})}}%
		%end area
			}[ ({\color{red}Typ "\type " nicht gefunden. Ändern oder in literatur.sty hinzufügen (siehe README)})]%
		}}%
	}%
	\IfStrEqCase{\entryfound}{%
			{false}{ ({\color{red}Literatureintrag mit Key "#1 " nicht gefunden})}%
	}%
}}

%Prints für verschiedene Fußnotenarten
%Area to add citecommands via gui
\newcommand{\citeBuch}[3]{%
	\textit{#1}, #2, #3%
}
\newcommand{\citeKommentar}[4]{%
	\textit{#1}, #2, #3#4%
}
\newcommand{\citeAufsatz}[3]{%
	\textit{#1}, #2, #3%
}
\newcommand{\citeonline}[2]{%
	\textit{#1}#2%
}
\newcommand{\citeworkingpaper}[2]{%
	\textit{#1}, #2%
}
\newcommand{\citesammelwerk}[3]{%
	\textit{#1}, #2, #3%
}
\newcommand{\citehrsgsammel}[3]{%
	\textit{#1}, #2, #3%
}
\newcommand{\citemeintype}[3]{%
	\textit{#1}, #2#3%
}
\newcommand{\citeTest}[3]{%
	#1#2#3%
}
\newcommand{\citeAufsatzAusgabe}[3]{%
	\textit{#1} (#2), #3%
}
\newcommand{\citeAufsatzURL}[3]{%
	\textit{#1} (#2), #3%
}
\newcommand{\citeonlineArticle}[3]{%
	\textit{#1} (#2), #3%
}
\newcommand{\citeNorm}[2]{%
	\textit{#1}#2%
}
\newcommand{\citeTestM}[2]{%
	\textit{#1}#2%
}
\newcommand{\citeHandbuch}[2]{%
	\textit{#1} (Hg.), #2%
}
%end area

\endinput
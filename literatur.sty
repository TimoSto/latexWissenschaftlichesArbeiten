\NeedsTeXFormat{LaTeX2e}

\ProvidesPackage{literatur}

%Literatur-DB aus CSV laden
\usepackage{xstring}
\DTLloaddb{literatur}{literatur.csv}
%Literaturverzeichnis printen
\newcommand{\printMyBibliography}[0]{
	
	\begin{center}
		\begin{LARGE}
			Literaturverzeichnis
		\end{LARGE}
	\end{center}
	%Jeder Eintrag in CSV-Datei (literatur-DB) wird auf den type überprüft und die Daten werden an den jeweiligen Command weitergegeben. (Falls type anders ist, kommt es zu einem Fehler)
	\DTLforeach*{literatur}
	{\key=key,\type=type,\autor=autor,\titel=titel,\auflage=auflage,\ort=ort,\datum=datum,\hrsg=hrsg,\band=band,\zeitschrift=zeitschrift,\seiten=seiten,\festschrift=festschrift,\autorsammel=autorsammelwerk,\titelsammel=titelsammelwerk,\url=url,\stand=stand}
	{
		\IfStrEqCase{\type}{%
		%Area to add new bibifs via gui
		{buch}{\printbuch{\autor}{\titel}{\auflage}{\ort}{\datum}}%
		{kommentar}{\printkommentar{\autor}{\titel}{\auflage}{\ort}{\datum}}%
		{aufsatz}{\printaufsatz{\autor}{\titel}{\zeitschrift}{\datum}{\seiten}}%
		{online}{\printonline{\autor}{\titel}{\url}{\stand}{\datum}}%
		{workingpaper}{\printworkingpaper{\autor}{\titel}{\datum}{\url}}%
		{sammelwerk}{\printsammelwerk{\autor}{\titel}{\zeitschrift}{\datum}{\seiten}}%
		%end area
		{empty}{}%
    }[Oppsss, unknown case '\type'.]
	}
}

%!!!LEERZEILE IN PRINTS NICHT ENTFERNEN!!! (Sind wichtig, damit ab zweiter Zeile immer eingerückt ist)
\def\bibparindent{1.5em}
%Area to add new bibprints via gui
\newcommand{\printbuch}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3. Auflage, #4 #5
	\\
	\vspace{-12pt}

}
\newcommand{\printkommentar}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3. Auflage,#4#5
	\\
	\vspace{-12pt}

}
\newcommand{\printaufsatz}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3, #4 #5 
	\\
	\vspace{-12pt}

}
\newcommand{\printonline}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3 (#4), abgerufen am #5
	\\
	\vspace{-12pt}

}
\newcommand{\printworkingpaper}[4]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1}, #2, #3, abrufbar unter: #4
	\\
	\vspace{-12pt}

}
\newcommand{\printsammelwerk}[5]{
	\hangindent=\bibparindent
	\parindent 0pt
	\hangafter=1
	\textit{#1} (Hrsg.), #2, in: #3  (#4), #5
	\\
	\vspace{-12pt}

}

		%end area

%Zitation => Suche nach Key in literatur-DB => Passenden Command aufrufen
%\newcommand{\citebib}[3]{%
%	\DTLforeach*{literatur}%
%	{\key=key,\type=type,\autor=autor,\titel=titel,\auflage=auflage,\ort=ort,\datum=datum,\hrsg=hrsg,\band=band,\zeitschrift=zeitschrift,\seiten=seiten,\festschrift=festschrift,\autorsammel=autorsammelwerk,\titelsammel=titelsammelwerk}%
%	{%
%	  \IfEqCase{\key}{{#1}{%
%		\IfEqCase{\type}{%
%	  	{buch}{\printbookfootnote{#2}{\autor}{\titel}{\datum}{#3}}%
%	  	%{hrsgbook}{\printhrsgbookfootnote{#2}{\autor}{\b}{\e}{#3}}%
%	  	{kommentar}{\printcommentfootnote{#2}{\autor}{\titel}{\datum}{#3}}%
%	  	{essay}{\printarticlefootnote{#2}{\autor}{\zeitschrift}{\datum}{#3}}%
%		{festschrift}{\printfestschriftfootnote{#2}{\autor}{\festschrift}{\datum}{#3}}%
%	  	{sammelwerk}{\printcollectionfootnote{#2}{\autor}{\autorsammel}{\titelsammel}{#3}}%
%	  	{online}{\printonlinefootnote{#2}{\autor}{\titel}{\titelsammel}{\datum}}%
%	  }%
%	  }}[]%
%	}%
%}
\usepackage{xcolor}

\newcommand{\entryfound}{false}%
\newcommand{\citebib}[3]{{%
	\renewcommand{\entryfound}{false}%
	\DTLforeach*{literatur}%
	{\key=key,\type=type,\autor=autor,\titel=titel,\auflage=auflage,\ort=ort,\datum=datum,\hrsg=hrsg,\band=band,\zeitschrift=zeitschrift,\seiten=seiten,\festschrift=festschrift,\autorsammel=autorsammelwerk,\titelsammel=titelsammelwerk,\url=url,\stand=stand}%
	{%
		\IfStrEqCase{\key}{{#1}{%
			\renewcommand{\entryfound}{true}%
			\IfStrEqCase{\type}{%
				%Area to add citeifs via gui
			{buch}{\footnote{#3\citebuch{\autor}{\titel}{\datum}{#2}}}%
			{kommentar}{\footnote{#3\citekommentar{\autor}{\titel}{\datum}{#2}}}%
			{aufsatz}{\footnote{#3\citeaufsatz{\autor}{\zeitschrift}{\datum}{#2}}}%
			{online}{\footnote{#3\citeonline{\autor}{\titel}{\stand}{#2}}}%
			{workingpaper}{\footnote{#3\citeworkingpaper{\autor}{\titel}{#2}}}%
			{sammelwerk}{\footnote{#3\citesammelwerk{\autor}{\titel}{#2}}}%
		%end area
			}[\footnote{{\color{red}Typ "\type " nicht gefunden. Ändern oder in literatur.sty hinzufügen (siehe README)}}]%
		}}%
	}%
	\IfStrEqCase{\entryfound}{%
		{false}{\footnote{{\color{red}Literatureintrag mit Key "#1 " nicht gefunden}}}%
	}%
}}

%Prints für verschiedene Fußnotenarten
%Area to add citecommands via gui
\newcommand{\citebuch}[4]{
	\textit{#1}, #2, #3, #4.
}
\newcommand{\citekommentar}[4]{
	\textit{#1}, #2, #3#4.
}
\newcommand{\citeaufsatz}[4]{
	\textit{#1}, #2, #3, #4.
}
\newcommand{\citeonline}[4]{
	\textit{#1}, #2, #3#4.
}
\newcommand{\citeworkingpaper}[3]{
	\textit{#1}, #2, #3.
}
\newcommand{\citesammelwerk}[3]{
	\textit{#1} , #2, #3.
}
%end area

\endinput